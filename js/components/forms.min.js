"use strict";var RTForm=function(){let t,e,a,i="",n=!1,l="";var r=function(){var t=a.getFields(),e=Object.keys(t);let i=e.length;for(var n=0;n<i;n++){var l=document.getElementsByName(e[n]);if(l&&RTUtil.hasClass(l[0],"is-invalid"))return void l[0].focus()}},o=function(t){var e={},a=RTUtil.getById(t);for(let t=0;t<a.elements.length;t++){var i=a.elements[t];i.name&&"password"!==i.name.toLowerCase()&&"__RequestVerificationToken"!==i.name&&(e[i.name]=i.value)}return e},d=function(t){var e={},a=RTUtil.getById(t);for(let t=0;t<a.elements.length;t++){var i=a.elements[t];e[i.name]=i.value}return e},u=function(t){t||(t="btnsubmit");var e=document.getElementById(t);e&&(e.onclick=RTForm.validateForm)},s=function(t){RTUtil.addEvent(RTUtil.getById(t),"change",(function(){!function(t){var e=o(t),a=window.location.pathname;RTUtil.ajaxPost("/home/savedata?formId="+encodeURIComponent(t)+"&uri="+encodeURIComponent(a),JSON.stringify(e),null)}(t)})),document.querySelectorAll("#"+t).length>1&&console.log("There are more than one elements with the form id provided "+t+" the script will take the first one, if you are having an issue with the form validation, please check to make sure there is only one element with the formId on it.");for(var e=RTUtil.getById(t).elements,i={},n=0;n<e.length;n++){var l=e[n].id,r=e[n].name,d=e[n].type;if(l&&("text"===d||"textarea"===d||"tel"===d||"radio"===d||"number"===d||"password"===d||"checkbox"===d||"date"===d||"email"===d||"select-one"===d)){var u={},s=RTUtil.getById(l).getAttribute("data-val-required");s&&(u.notEmpty={message:s});var c=RTUtil.getById(l).getAttribute("data-val-length");c&&(u.stringLength={max:RTUtil.getById(l).getAttribute("data-val-length-max"),message:c});var m=RTUtil.getById(l).getAttribute("data-val-regex");m&&(u.regexp={regexp:RTUtil.getById(l).getAttribute("data-val-regex-pattern"),message:m});var v=RTUtil.getById(l).getAttribute("data-fv-greater-than___min");v&&(u.greaterThan={min:v,message:RTUtil.getById(l).getAttribute("data-fv-greater-than___message")});var f=RTUtil.getById(l).getAttribute("data-val-equalto");if(f){var T=RTUtil.getById(l).getAttribute("data-val-equalto-other").replace("*.","");u.identical={message:f,compare:function(){return RTUtil.getById(T).value}}}var R=RTUtil.getById(l).getAttribute("data-val-atleastonerequired");if(R){var p=RTUtil.getById(l).getAttribute("data-val-atleastonerequired-properties");u.callback={message:R,callback:function(t){var e=!0,i=p.split(",");for(let t=0;t<i.length;t++){let a=i[t];if("addressSelect"===a)null===RTUtil.getById(a)&&""!==RTUtil.getById("Address_PostCode").value&&RTUtil.getById("selectedAddress").innerHTML.length<5&&RTAddressFinder.loadAddressesVC(RTUtil.getById("Address_PostCode").value);else{if(null===RTUtil.getById(a)){e=!0;break}if(""!==RTUtil.getById(a).value){e=!1;break}}}return!e&&(a.updateFieldStatus(i[0],"Valid"),!0)}}}RTUtil.getById(l).getAttribute("data-val-requiredselect")&&(u.choice={min:1,max:1,message:"please select an address"});var y=RTUtil.getById(l).getAttribute("data-val-mustbetrue");y&&(u.callback={message:y,callback:function(t){return"checkbox"!==t.element.type||t.element.checked}});let t=RTUtil.getById(l).getAttribute("data-val-requiredif"),n=RTUtil.getById(l).getAttribute("data-val-requiredif-dependentproperty"),o=RTUtil.getById(l).getAttribute("data-val-requiredif-targetvalue");if(t){let a={message:t,callback:function(t){var a=e[n];if(RTUtil.isNodeList(a)){for(let e=0;e<a.length;e++)if(a[e].value===o&&a[e].checked)return""!==t.element.value;return!0}return a.value===o?""!==t.element.value:"checkbox"!==t.element.type||t.element.checked}};u.callback=a}var b=RTUtil.getById(l).getAttribute("data-val-isnumberplate");b&&(u.callback={message:b,callback:function(t){return"invalid"!==RTPlate.addSpaceToPlate(t.value)}});var U=RTUtil.getById(l).getAttribute("data-val-isnumberplateorempty");U&&(u.callback={message:U,callback:function(t){if(""===t.value)return!0;return"invalid"!==RTPlate.addSpaceToPlate(t.value)}});var h=RTUtil.getById(l).getAttribute("data-val-email");h&&(u.emailAddress={message:h}),RTUtil.getById(l).getAttribute("data-val-validemail")&&(u.callback={message:"Invalid email",callback:function(t){return RTUtil.hide("emailWarning"),g(RTUtil.getById(t).value)&&RTUtil.ajaxGet("/formvalidation-email?email="+encodeURIComponent(RTUtil.getById(t).value),(function(t){JSON.parse(t).valid||RTUtil.show("emailWarning")})),{valid:!0,message:"A message"}}});var B=RTUtil.getById(l).getAttribute("data-val-isdatelessnumberplate");B&&(u.callback={message:B,callback:function(t){if("invalid"===RTPlate.addSpaceToPlate(t.value))return!1;return"DATELESS"===RTPlate.getPlateType(t.value.replace(/ /g,""))}});var I={};I.validators=u,Object.keys(I.validators).length>0&&(i[r]=I)}}return i},g=function(t){const e=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return console.log(e.test(String(t).toLowerCase())),e.test(String(t).toLowerCase())},c=function(t,e){var a=RTUtil.getById(t).elements;for(let t=0;t<a.length;t++){let i=a[t].id;if(i.length>0&&"hidden"!=a[t].type){RTUtil.hasClass(RTUtil.getById(i),"input-validation-error")&&(RTUtil.hasAttr(RTUtil.getById(i),"data-val-regex")?m(i,e,"regexp"):RTUtil.hasAttr(RTUtil.getById(i),"data-val-length")?m(i,e,"stringLength"):RTUtil.hasAttr(RTUtil.getById(i),"data-val-required")&&m(i,e,"notEmpty"))}}},m=function(t,e,a){let i=RTUtil.getById(t).name,n=RTUtil.getById(t).nextElementSibling;if(n){if(RTUtil.hasClass(n,"field-validation-error")){let t=n.innerText;e.updateValidatorOption(i,a,"message",t)}"hidden"!=RTUtil.getById(t).type&&e.updateFieldStatus(i,"Invalid",a)}};return{init:function(t){if(RTUtil.getById(t))return function(t,e){i=t,a=FormValidation.formValidation(RTUtil.getById(t),{fields:s(t),plugins:{trigger:new FormValidation.plugins.Trigger,bootstrap:new FormValidation.plugins.Bootstrap,icon:new FormValidation.plugins.Icon({valid:"",invalid:"",validating:""})}}).on("core.form.invalid",(function(t){r()})),c(t,a),u(e)}(t)},initNoCaptcha:function(t){if(RTUtil.getById(t))return function(t){i=t,a=FormValidation.formValidation(RTUtil.getById(t),{fields:s(t),plugins:{trigger:new FormValidation.plugins.Trigger,bootstrap:new FormValidation.plugins.Bootstrap,submitButton:new FormValidation.plugins.SubmitButton,icon:new FormValidation.plugins.Icon({valid:"",invalid:"",validating:""}),defaultSubmit:new FormValidation.plugins.DefaultSubmit}}).on("core.form.invalid",(function(t){r()})),c(t,a)}(t)},initFormNoCaptchaAjax:function(t,e,l,o){if(RTUtil.getById(t))return function(t,e,l,o){return i=t,n=!0,a=FormValidation.formValidation(RTUtil.getById(t),{fields:s(t),plugins:{trigger:new FormValidation.plugins.Trigger({event:{Email:"blur"}}),bootstrap:new FormValidation.plugins.Bootstrap,submitButton:new FormValidation.plugins.SubmitButton,icon:new FormValidation.plugins.Icon({valid:"",invalid:"",validating:""})}}).on("core.form.valid",(function(){l||(l="GET");var a=RTUtil.getById("btnsubmit");a&&(a.disabled=!0),""!==e?FormValidation.utils.fetch(e,{method:l,params:d(t)}).then((function(t){a&&(a.disabled=!1),o&&o(t)})):(a&&(a.disabled=!1),o&&o())})).on("core.form.invalid",(function(t){r()})),a}(t,e,l,o)},initFormAjax:function(o,d,g,c,m){if(RTUtil.getById(o))return function(o,d,g,c,m){i=o,n=!0,l=g,e=m,t=c,a=FormValidation.formValidation(RTUtil.getById(o),{fields:s(o),plugins:{trigger:new FormValidation.plugins.Trigger,bootstrap:new FormValidation.plugins.Bootstrap,submitButton:new FormValidation.plugins.SubmitButton,icon:new FormValidation.plugins.Icon({valid:"",invalid:"",validating:""})}}).on("core.form.invalid",(function(t){r()})),u(d)}(o,d,g,c,m)},setupValidators:function(t){if(RTUtil.getById(t))return s(t)},handleServerSideValidation:function(t,e){RTUtil.getById(t)&&c(t,e)},validateForm:function(t){!function(t){t.preventDefault(),a.validate().then((function(t){"Valid"===t&&grecaptcha.execute()}))}(t)},onLoad:function(){_onload()},onSubmit:function(r){!function(r){document.getElementById("reCaptchaToken").value=r,a.validate().then((function(a){"Valid"===a&&(n?(t||(t="GET"),FormValidation.utils.fetch(l,{method:t,params:o(i)}).then((function(t){e&&e(t)}))):document.getElementById(i).submit())}))}(r)},isFormValidated:function(t,e,n){if(RTUtil.getById(t))return function(t,e,n){return i=t,a.validate().then((function(t){let a=RTUtil.getById(e);return"Valid"===t?(console.log("Form validated"),a.disabled=!0,RTUtil.show(n),!0):(console.log("Form not validated"),a.disabled=!1,RTUtil.hide(n),!1)}))}(t,e,n)}}}();function onReCaptchaSubmit(t){RTForm.onSubmit(t)}